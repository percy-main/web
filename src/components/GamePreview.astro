---
import { Image } from "astro:assets";
import type { Game } from "../collections/game";
import { formatDate } from "date-fns";
import { IoChevronForward } from "react-icons/io5";

type Props = {
  id: string;
  game: Game;
  sponsorshipPriceId: string;
};

const { id, game, sponsorshipPriceId } = Astro.props;
---

<div class="bg-white rounded-lg shadow-md border p-4 mb-4">
  <div class="flex flex-row items-center justify-stretch gap-4">
    <Image
      src="/images/cricket.png"
      alt="Cricket Match"
      title="Cricket Match"
      width="24"
      height="24"
      loading="eager"
    />
    <div class="w-full">
      <h5 class="text-lg font-semibold">
        {formatDate(game.when, "dd/MM/yyyy")}
      </h5>
      <p>
        {game.team} versus {game.opposition}{" "}
        {game.home ? "(H)" : "(A)"}
      </p>
      <p>{game.league}</p>
    </div>
    <a
      href={`/calendar/event/${id}`}
      class="self-stretch flex flex-col items-center justify-center"
    >
      <IoChevronForward fontSize={32} />
    </a>
  </div>
  {
    game.hasSponsor ? (
      <p class="justify-self-center py-2 px-4 mt-2 bg-green-500 text-dark rounded text-sm">
        Sponsor: {game.sponsor?.name ?? "Pending"}
      </p>
    ) : (
      <div class="justify-self-center mt-2 py-2 px-4  bg-blue-500 hover:bg-blue-700 text-white rounded text-sm">
        <a
          href={`/purchase/${sponsorshipPriceId}?metadata=${JSON.stringify({ gameId: id })}`}
        >
          Sponsor This Game
        </a>
      </div>
    )
  }
</div>
