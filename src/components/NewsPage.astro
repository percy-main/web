---
import ArticlePreview from "@/components/ArticlePreview.astro";
import type { Page } from "astro";
import type { InferEntrySchema } from "astro:content";
import { IoChevronBack, IoChevronForward } from "react-icons/io5";

type Props = {
  articles: Array<{ id: string } & InferEntrySchema<"news">>;
  page: Pick<Page, "url" | "currentPage" | "lastPage">;
  tags: Array<{
    id: string;
    slug: string;
    title: string;
    count: number;
    isActive: boolean;
  }>;
};

const { articles, page, tags } = Astro.props;
---

<div class="flex flex-col-reverse md:flex-row">
  <aside
    class="mb-4 w-full border-b-2 border-gray-300 pb-2 sm:w-64 md:mb-0 md:border-0 md:pb-0"
  >
    <nav class="flex flex-col text-sm">
      <h5>Filter By Tag</h5>
      <ul class="flex flex-col gap-2">
        {
          tags.map(({ title, slug, count, isActive }) => (
            <a
              href={`/news/tag/${slug}/1`}
              class="py-1"
              class:list={[
                isActive
                  ? "font-medium ml-[-1.76rem] border-l-4 border-primary pl-4 text-primary"
                  : "text-gray-700 hover:text-primary",
              ]}
            >
              <span class:list={isActive ? ["pl-2"] : []}>
                {title} ({count})
              </span>
            </a>
          ))
        }
      </ul>
    </nav>
  </aside>
  <div class="flex w-full flex-col space-y-4">
    {
      (page.url.prev || page.url.next) && (
        <nav>
          <div class="flex w-full items-center justify-between gap-4">
            {page.url.next ? (
              <a href={page.url.next} title="Newer" class="flex items-center gap-1 text-sm text-gray-700 hover:text-primary">
                <IoChevronBack fontSize={20} />
                <span>Newer</span>
              </a>
            ) : <div />}
            <span class="text-sm text-gray-500">Page {page.currentPage} of {page.lastPage}</span>
            {page.url.prev ? (
              <a href={page.url.prev} title="Older" class="flex items-center gap-1 text-sm text-gray-700 hover:text-primary">
                <span>Older</span>
                <IoChevronForward fontSize={20} />
              </a>
            ) : <div />}
          </div>
        </nav>
      )
    }
    <section>
      <ul
        class="mx-auto mb-4 flex grow flex-col flex-wrap items-stretch justify-between gap-4"
      >
        {
          articles.map((article) => (
            <li class="w-full">
              <div class="rounded-lg bg-white p-5 shadow-sm">
                <ArticlePreview {...article} />
              </div>
            </li>
          ))
        }
      </ul>
    </section>
    {
      (page.url.prev || page.url.next) && (
        <nav>
          <div class="flex w-full items-center justify-between gap-4">
            {page.url.next ? (
              <a href={page.url.next} title="Newer" class="flex items-center gap-1 text-sm text-gray-700 hover:text-primary">
                <IoChevronBack fontSize={20} />
                <span>Newer</span>
              </a>
            ) : <div />}
            <span class="text-sm text-gray-500">Page {page.currentPage} of {page.lastPage}</span>
            {page.url.prev ? (
              <a href={page.url.prev} title="Older" class="flex items-center gap-1 text-sm text-gray-700 hover:text-primary">
                <span>Older</span>
                <IoChevronForward fontSize={20} />
              </a>
            ) : <div />}
          </div>
        </nav>
      )
    }
  </div>
</div>
