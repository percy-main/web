---
import ArticlePreview from "@/components/ArticlePreview.astro";
import type { Page } from "astro";
import type { InferEntrySchema } from "astro:content";
import { IoChevronBack, IoChevronForward } from "react-icons/io5";

type Props = {
  articles: Array<{ id: string } & InferEntrySchema<"news">>;
  page: Pick<Page, "url">;
  tags: Array<{
    id: string;
    slug: string;
    title: string;
    count: number;
    isActive: boolean;
  }>;
};

const { articles, page, tags } = Astro.props;
---

<div class="flex flex-col-reverse md:flex-row">
  <aside
    class="w-full sm:w-60 dark:bg-gray-50 dark:text-gray-800 border-b-2 border-gray-400 pb-2 md:pb-0 md:border-0 mb-4 md:mb-0"
  >
    <nav class="text-sm flex flex-col">
      <h5>Filter By Tag</h5>
      <ul class="flex flex-col gap-2">
        {
          tags.map(({ title, slug, count, isActive }) => (
            <a
              href={`/news/tag/${slug}/1`}
              class="py-1"
              class:list={[
                isActive
                  ? "border-gray-500 border-l-4 pl-4 ml-[-1.76rem] text-bold text-orange-900"
                  : "",
              ]}
            >
              <span class:list={isActive ? ["pl-2"] : []}>
                {title} ({count})
              </span>
            </a>
          ))
        }
      </ul>
    </nav>
  </aside>
  <div class="flex flex-col w-full space-y-4">
    {
      (page.url.prev || page.url.next) && (
        <nav>
          <div class="flex items-center justify-between gap-4 w-full">
            {page.url.prev && (
              <a href={page.url.prev} title="Previous Page">
                <IoChevronBack
                  className="text-gray-700 hover:text-gray-400"
                  fontSize={32}
                />
              </a>
            )}
            {page.url.next && (
              <a href={page.url.next} title="Next Page">
                <IoChevronBack
                  className="text-gray-700 hover:text-gray-400"
                  fontSize={32}
                />
              </a>
            )}
          </div>
        </nav>
      )
    }
    <section>
      <ul
        class="flex flex-col gap-4 items-stretch justify-between flex-wrap grow mb-4 mx-auto"
      >
        {
          articles.map((article) => (
            <li class="w-full">
              <ArticlePreview
                id={article.id}
                title={article.title}
                when={article.when}
                summary={article.summary}
                author={article.author}
                pages={article.pages}
              />
            </li>
          ))
        }
      </ul>
    </section>
    {
      (page.url.prev || page.url.next) && (
        <nav>
          <div class="flex items-center justify-between gap-4 w-full">
            {page.url.prev && (
              <a href={page.url.prev} title="Previous Page">
                <IoChevronBack
                  className="text-gray-700 hover:text-gray-400"
                  fontSize={32}
                />
              </a>
            )}
            {page.url.next && (
              <a href={page.url.next} title="Next Page">
                <IoChevronBack
                  className="text-gray-700 hover:text-gray-400"
                  fontSize={32}
                />
              </a>
            )}
          </div>
        </nav>
      )
    }
  </div>
</div>
