---
import { RichText } from "@/components/RichText";
import { formatDate } from "date-fns";
import type { News } from "@/collections/news";

type Props = {
  article: { id: string } & News;
};

const { article } = Astro.props;
const { title, when, summary, author, slug } = article;
const initials = author?.name
  ? author.name
      .split(" ")
      .map((w) => w[0])
      .join("")
      .toUpperCase()
      .slice(0, 2)
  : "?";
---

<a href={`/news/article/${slug}`} class="featured-card block relative bg-white rounded-2xl mb-7 overflow-hidden cursor-pointer">
  {/* Gradient accent bar */}
  <div class="h-1 bg-gradient-to-r from-primary via-primary-light to-cta"></div>

  <div class="p-5 sm:p-7 pb-6 flex flex-col gap-3.5">
    {/* Top row: Latest badge + date */}
    <div class="flex items-center gap-3">
      <span class="inline-flex items-center gap-1.5 bg-primary text-white px-3 py-1 rounded-md text-[11px] font-bold tracking-wider uppercase">
        <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        Latest
      </span>
      <span class="text-[13px] text-text opacity-45">
        {formatDate(when, "d MMMM yyyy")}
      </span>
    </div>

    {/* Title */}
    <h2 class="featured-title font-secondary text-[22px] sm:text-[28px] font-bold text-dark leading-snug m-0 transition-colors duration-200">
      {title}
    </h2>

    {/* Summary */}
    <div class="text-[15.5px] leading-relaxed text-text opacity-75 line-clamp-3">
      <RichText
        client:only="react"
        page=""
        document={summary}
        games={[]}
      />
    </div>

    {/* Bottom row: author + CTA */}
    <div class="flex items-center justify-between pt-4 border-t border-black/5">
      <div class="flex items-center gap-2.5">
        {author?.photo ? (
          <img
            class="h-8 w-8 rounded-full shrink-0"
            src={author.photo.url}
            alt={author.name}
          />
        ) : (
          <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-home-bg text-primary">
            {initials}
          </div>
        )}
        <span class="text-sm font-semibold text-dark">
          {author?.name}
        </span>
      </div>
      <span class="featured-read-more inline-flex items-center gap-2 text-sm font-semibold text-primary">
        Read article
        <span class="arrow-circle w-7 h-7 rounded-full bg-home-bg flex items-center justify-center transition-all duration-200">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
        </span>
      </span>
    </div>
  </div>
</a>

<style>
  .featured-card {
    transition: transform 0.3s cubic-bezier(0.22, 1, 0.36, 1),
                box-shadow 0.3s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.03);
  }
  .featured-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 48px rgba(27, 61, 47, 0.1), 0 8px 16px rgba(0, 0, 0, 0.04);
  }
  .featured-card:hover .featured-title {
    color: #1B3D2F;
  }
  .featured-read-more {
    transition: gap 0.2s;
  }
  .featured-card:hover .featured-read-more {
    gap: 12px;
  }
  .featured-card:hover .arrow-circle {
    background: #1B3D2F;
    color: white;
  }
  @media (max-width: 768px) {
    .featured-title {
      font-size: 22px;
    }
  }
</style>
