---
import { getCollection } from "astro:content";
import Base from "@/layouts/Base.astro";
import { match } from "ts-pattern";
import Event from "@/components/CalendarItem.astro";

export async function getStaticPaths() {
  const pages = await getCollection("calendarItem");
  return pages.map((calendarItem) => ({
    params: { id: calendarItem.id },
    props: { calendarItem },
  }));
}

const { calendarItem } = Astro.props;

const title = match(calendarItem)
  .with(
    { data: { type: "game" } },
    (game) =>
      `${game.data.team} versus ${game.data.opposition} ${game.data.home ? "(H)" : "(A)"}`
  )
  .with({ data: { type: "event" } }, (event) => event.data.name)
  .exhaustive();
---

<Base title={title}>
  <Event title={title} calendarItem={calendarItem.data} id={calendarItem.id} />
</Base>
